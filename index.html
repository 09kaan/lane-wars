<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Warlords: Call to Arms Mobile</title>
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">
    <style>
        :root {
            --wood: #5d4037;
            --gold: #fbc02d;
            --player-bg: #1565c0;
            --enemy-bg: #c62828;
            --grass: #2e7d32;
        }

        body {
            background: #121212;
            color: #f5f5f5;
            font-family: 'MedievalSharp', cursive;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            touch-action: manipulation;
            overflow: hidden;
            height: 100vh;
        }

        /* √úst Panel (Altƒ±n ve Can) */
        #top-bar {
            width: 100%;
            max-width: 900px;
            height: 60px;
            background: var(--wood);
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-bottom: 4px solid #3e2723;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            z-index: 10;
        }

        .stat-box { font-size: 1.2rem; text-shadow: 2px 2px #000; }
        .gold-txt { color: var(--gold); }

        /* Oyun Alanƒ± */
        #game-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            flex-grow: 1;
            display: flex;
            align-items: center;
            background: #1b5e20;
        }

        canvas {
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #2e7d32 0%, #388e3c 100%);
            display: block;
        }

        /* Alt Panel (Birim Se√ßimi ve Kulvarlar) */
        #bottom-ui {
            width: 100%;
            max-width: 900px;
            background: #3e2723;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            box-sizing: border-box;
            border-top: 4px solid #2d1b18;
        }

        .unit-tray {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .unit-card {
            background: #5d4037;
            border: 3px solid #795548;
            border-radius: 8px;
            padding: 8px;
            width: 80px;
            text-align: center;
            cursor: pointer;
            transition: 0.1s;
        }

        .unit-card.selected {
            border-color: var(--gold);
            transform: scale(1.05);
            background: #795548;
        }

        .unit-card b { display: block; font-size: 0.8rem; }
        .unit-card span { color: var(--gold); font-size: 0.9rem; }

        .lane-controls {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
        }

        .lane-btn {
            background: var(--wood);
            border: 2px solid #3e2723;
            color: white;
            padding: 15px 0;
            border-radius: 5px;
            font-family: 'MedievalSharp';
            font-size: 1.2rem;
            cursor: pointer;
        }

        .lane-btn:active { background: var(--gold); color: black; }

        #win-screen {
            display: none;
            position: absolute;
            top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9); padding: 40px; border: 5px solid var(--gold);
            text-align: center; z-index: 100;
        }
    </style>
</head>
<body>

<div id="top-bar">
    <div class="stat-box gold-txt">üí∞ <span id="gold">200</span></div>
    <div class="stat-box">üè∞ <span id="p-hp" style="color:#2196f3">100</span></div>
    <div class="stat-box">üëπ <span id="e-hp" style="color:#f44336">100</span></div>
</div>

<div id="game-container">
    <canvas id="gameCanvas"></canvas>
    <div id="win-screen">
        <h1 id="win-msg">ZAFER!</h1>
        <button onclick="location.reload()" style="padding:10px 20px; font-family:MedievalSharp; cursor:pointer">Yeniden Ba≈üla</button>
    </div>
</div>

<div id="bottom-ui">
    <div class="unit-tray">
        <div class="unit-card selected" id="c-warrior" onclick="selectType('warrior')">
            <b>Piyade</b>
            <span>20G</span>
        </div>
        <div class="unit-card" id="c-archer" onclick="selectType('archer')">
            <b>Ok√ßu</b>
            <span>40G</span>
        </div>
        <div class="unit-card" id="c-knight" onclick="selectType('knight')">
            <b>≈û√∂valye</b>
            <span>80G</span>
        </div>
    </div>
    <div class="lane-controls">
        <button class="lane-btn" onclick="spawnUnit(0)">1</button>
        <button class="lane-btn" onclick="spawnUnit(1)">2</button>
        <button class="lane-btn" onclick="spawnUnit(2)">3</button>
        <button class="lane-btn" onclick="spawnUnit(3)">4</button>
        <button class="lane-btn" onclick="spawnUnit(4)">5</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    // Canvas Boyutlandƒ±rma
    function resize() {
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    let gold = 200;
    let playerHp = 100;
    let enemyHp = 100;
    let selectedType = 'warrior';
    let units = [];
    let arrows = [];
    let gameOver = false;

    const UNIT_TYPES = {
        warrior: { hp: 100, speed: 2, cost: 20, range: 10,  power: 1,  color: '#2196f3', type: 'melee' },
        archer:    { hp: 60,  speed: 1.5, cost: 40, range: 200, power: 0.5, color: '#4caf50', type: 'ranged' },
        knight:    { hp: 350, speed: 1,   cost: 80, range: 15,  power: 2,  color: '#ffeb3b', type: 'melee' }
    };

    class Arrow {
        constructor(x, y, team) {
            this.x = x; this.y = y; this.team = team;
            this.speed = team === 'p' ? 8 : -8;
            this.dead = false;
        }
        update() {
            this.x += this.speed;
            if(this.x < 0 || this.x > canvas.width) this.dead = true;
            units.forEach(u => {
                if(u.team !== this.team && Math.abs(this.x - u.x) < 20 && Math.abs(this.y - (u.y + u.h/2)) < 20) {
                    u.hp -= 30; this.dead = true;
                }
            });
        }
        draw() {
            ctx.fillStyle = "white";
            ctx.fillRect(this.x, this.y, 10, 2);
        }
    }

    class Unit {
        constructor(lane, type, team) {
            this.lane = lane; this.team = team; this.type = type;
            const data = UNIT_TYPES[type];
            this.hp = data.hp; this.maxHp = data.hp;
            this.speed = team === 'p' ? data.speed : -data.speed;
            this.range = data.range;
            this.power = data.power;
            this.w = 35; this.h = 35;
            this.x = team === 'p' ? -50 : canvas.width + 10;
            const laneHeight = canvas.height / 5;
            this.y = (lane * laneHeight) + (laneHeight / 2) - (this.h / 2);
            this.lastAtk = 0; this.dead = false;
        }

        draw() {
            // Shadow
            ctx.fillStyle = 'rgba(0,0,0,0.3)';
            ctx.fillRect(this.x + 5, this.y + 5, this.w, this.h);
            
            // Body
            ctx.fillStyle = this.team === 'p' ? '#2196f3' : '#f44336';
            if(this.type === 'knight') ctx.fillStyle = this.team === 'p' ? '#1976d2' : '#d32f2f';
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.strokeRect(this.x, this.y, this.w, this.h);
            ctx.fillRect(this.x, this.y, this.w, this.h);

            // HP Bar
            ctx.fillStyle = '#000';
            ctx.fillRect(this.x, this.y - 12, this.w, 6);
            ctx.fillStyle = (this.hp/this.maxHp) > 0.4 ? '#4caf50' : '#f44336';
            ctx.fillRect(this.x, this.y - 12, (this.hp/this.maxHp) * this.w, 6);
        }

        update() {
            let blocked = false;
            let target = null;

            for(let other of units) {
                if(other !== this && other.lane === this.lane && !other.dead) {
                    let dist = this.team === 'p' ? (other.x - (this.x + this.w)) : (this.x - (other.x + other.w));
                    if(dist > 0 && dist < this.range) {
                        if(this.team !== other.team) { blocked = true; target = other; }
                        else { blocked = true; }
                    }
                }
            }

            if(!blocked) this.x += this.speed;
            else if(target && Date.now() - this.lastAtk > 1000) {
                if(this.type === 'archer') arrows.push(new Arrow(this.x + (this.team === 'p' ? 35 : 0), this.y + 15, this.team));
                else target.hp -= 20 * this.power;
                this.lastAtk = Date.now();
            }

            if(this.team === 'p' && this.x > canvas.width) { enemyHp -= 10; this.dead = true; }
            if(this.team === 'e' && this.x < -40) { playerHp -= 10; this.dead = true; }
            if(this.hp <= 0) this.dead = true;
        }
    }

    function selectType(type) {
        selectedType = type;
        document.querySelectorAll('.unit-card').forEach(c => c.classList.remove('selected'));
        document.getElementById('c-' + type).classList.add('selected');
    }

    function spawnUnit(lane) {
        if(gameOver) return;
        const cost = UNIT_TYPES[selectedType].cost;
        if(gold >= cost) {
            gold -= cost;
            units.push(new Unit(lane, selectedType, 'p'));
            updateUI();
        }
    }

    function updateUI() {
        document.getElementById('gold').innerText = Math.floor(gold);
        document.getElementById('p-hp').innerText = playerHp;
        document.getElementById('e-hp').innerText = enemyHp;
        if(playerHp <= 0 || enemyHp <= 0) {
            gameOver = true;
            document.getElementById('win-screen').style.display = 'block';
            document.getElementById('win-msg').innerText = playerHp <= 0 ? "YENƒ∞LDƒ∞N!" : "ZAFER!";
        }
    }

    // AI & Gold
    setInterval(() => { if(!gameOver) { gold += 3; updateUI(); } }, 1000);
    setInterval(() => {
        if(gameOver) return;
        const types = ['warrior', 'archer', 'knight'];
        units.push(new Unit(Math.floor(Math.random()*5), types[Math.floor(Math.random()*3)], 'e'));
    }, 3500);

    function loop() {
        ctx.clearRect(0,0,canvas.width, canvas.height);
        
        // Lanes
        ctx.strokeStyle = 'rgba(255,255,255,0.1)';
        const lh = canvas.height / 5;
        for(let i=1; i<5; i++) {
            ctx.beginPath(); ctx.moveTo(0, i*lh); ctx.lineTo(canvas.width, i*lh); ctx.stroke();
        }

        arrows = arrows.filter(a => !a.dead);
        arrows.forEach(a => { a.update(); a.draw(); });
        units = units.filter(u => !u.dead);
        units.forEach(u => { u.update(); u.draw(); });

        if(!gameOver) requestAnimationFrame(loop);
    }
    loop();
</script>
</body>
</html>
